{% load static %}
<!--!
  @file base.html
  @brief Plantilla base con header, footer y bloques extendibles.
  @details
   - Define la estructura principal de la web (header, contenido, footer).
   - Incluye bloques `block` de Django para sobreescribir contenido en otras plantillas.
   - Usa estilos globales, íconos FontAwesome y fuente Poppins.
-->
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>{% block title %}ViviendaYA!{% endblock %}</title>

  <!--! @section css_global CSS global -->
  <link rel="stylesheet" href="{% static 'css/base.css' %}">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">

  <!-- CSRF para JS si lo necesitas -->
  <meta name="csrf-token" content="{{ csrf_token }}"/>

  <!-- Bloques opcionales para metas/estilos extra -->
  {% block extra_head %}{% endblock %}
  {% block extra_css %}{% endblock %}
</head>
<body>
  <!--! @section header Encabezado principal -->
  <header class="header" role="banner">
    <div class="header-content">
      <div class="zona-izquierda">
        <h1 class="nombre-sitio">
          <a href="{% url 'principal:home' %}" class="logo-link" aria-label="Ir al inicio">ViviendaYa!</a>
        </h1>
      </div>

      <div class="zona-derecha">
        <nav class="navbar-actions" role="navigation" aria-label="Principal">

          {% if user.is_authenticated %}
            
            {% if request.resolver_match.url_name == 'ver_perfil' %}
              <!-- Si estamos en perfil, Home va primero -->
              <a href="{% url 'principal:home' %}" class="btn-login">
                <i class="fas fa-home"></i> Home
              </a>
              <a href="{% url 'principal:mis_favoritos' %}" class="btn-login">
                <i class="fas fa-heart"></i> Me encantas
              </a>
              <a href="{% url 'publicaciones:panel' %}" class="btn-login">
                <i class="fas fa-home"></i> Vender/Rentar
              </a>
            {% else %}
              <!-- En cualquier otra vista, orden normal -->
              <a href="{% url 'principal:mis_favoritos' %}" class="btn-login">
                <i class="fas fa-heart"></i> Mis favoritos
              </a>
              <a href="{% url 'publicaciones:panel' %}" class="btn-login">
                <i class="fas fa-home"></i> Vender/Rentar
              </a>
              <a href="{% url 'cuentas:ver_perfil' %}" class="btn-login">
                <i class="fas fa-id-card"></i> Ver perfil
              </a>
            {% endif %}
            
            <!-- Usuario actual -->
            <span class="btn-login" aria-label="Usuario actual">
              <i class="fas fa-user"></i> {{ user.username }}
            </span>
            <a href="{% url 'account_logout' %}" class="btn-login">
              <i class="fas fa-sign-out-alt"></i> Salir
            </a>
          {% else %}
            <!-- Si no hay sesión, que mande a login pero con next a mis_favoritos -->
            <a href="{% url 'account_login' %}?next={% url 'principal:mis_favoritos' %}" class="btn-login">
              <i class="fas fa-heart"></i> Me encantas
            </a>
            <a href="{% url 'account_login' %}" class="btn-login">
              <i class="fas fa-user"></i> Iniciar sesión
            </a>
          {% endif %}
        </nav>
      </div>
    </div>
  </header>
  <!--! @endsection header -->

  <!--! @section top_banner Banner superior opcional -->
  {% block top_banner %}{% endblock %}

  <!--! @section main Contenido principal -->
  <main class="contenido-pagina">
    {% block content %}{% endblock %}
  </main>
  <!--! @endsection main -->

  <!--! @section footer Pie de página -->
  <footer class="footer" role="contentinfo">
    <div class="footer-wrap">
      <div class="footer-col brand">
        <div class="brand-row">
          <span class="brand-mark">V</span>
          <span class="brand-name">ViviendaYa!</span>
        </div>
        <p>
          Tu socio confiable en el mercado inmobiliario.<br>
          Conectamos personas con sus hogares ideales.
        </p>
      </div>

      <div class="footer-col">
        <h4>Servicios</h4>
        <ul>
          <li><a href="#">Comprar propiedades</a></li>
          <li><a href="#">Rentar propiedades</a></li>
          <li><a href="#">Vender tu propiedad</a></li>
        </ul>
      </div>

      <div class="footer-col">
        <h4>Soporte</h4>
        <ul>
          <li><a href="#">Centro de ayuda</a></li>
          <li><a href="#">Términos de uso</a></li>
          <li><a href="#">Política de privacidad</a></li>
        </ul>
      </div>

      <div class="footer-col contact">
        <h4>Contacto</h4>
        <ul>
          <li><i class="fas fa-phone"></i> +1800 0000</li>
          <li><i class="fas fa-envelope"></i> viviendayamx@gmail.com</li>
          <li><i class="fas fa-location-dot"></i> ViviendaYa!</li>
        </ul>
      </div>
    </div>

    <div class="footer-bar">
      <p>© 2025 ViviendaYA! | Todos los derechos reservados</p>
      <p>Desarrollado con <span class="heart">❤</span> para encontrar tu hogar ideal</p>
    </div>
  </footer>
  <!--! @endsection footer -->

  <!--! @section extra_js Scripts adicionales -->
  {% block extra_js %}{% endblock %}
  <!--! @endsection extra_js -->
</body>
</html>
